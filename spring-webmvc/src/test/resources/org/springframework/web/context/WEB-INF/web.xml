<?xml version="1.0" encoding="UTF-8"?>


<web-app>
	<display-name>ticket-webapp</display-name>
	<description>Web interface for ticket application</description>

	<distributable/>

	<!--
	<listener>
		<listener-class>com.wrox.j2eedd.ticket.web.SessionCleanupListener</listener-class>
	</listener>
-->


	<!-- This servlet must be loaded first to configure the log4j
	 system and create the WebApplicationContext
	 -->
	<servlet>
		<servlet-name>config</servlet-name>
		<servlet-class>org.springframework.framework.web.context.ContextLoaderServlet</servlet-class>
		<init-param>
			<param-name>contextClass</param-name>
			<param-value>org.springframework.framework.web.context.XMLWebApplicationContext</param-value>   	
		</init-param>
		<init-param>
			<param-name>log4jPropertiesUrl</param-name>
			<param-value>/WEB-INF/log4j_PRODUCTION.properties</param-value>   	
		</init-param>
		<!-- This is essential -->
		<load-on-startup>1</load-on-startup>
	  </servlet>
    <servlet>
        <servlet-name>For_Sale_Items_Interface</servlet-name>
        <servlet-class>apps.For_Sale_Items_Interface</servlet-class>
    </servlet>
    <!--<servlet>
        <servlet-name>Admin_For_Sale_Items_Interface</servlet-name>
        <servlet-class>apps.Admin_For_Sale_Items_Interface</servlet-class>
    </servlet>
    <servlet>
        <servlet-name>Admin_Product_Details_Interface</servlet-name>
        <servlet-class>apps.Admin_Product_Details_Interface</servlet-class>
    </servlet>
    <servlet>
        <servlet-name>Product_Reviews_Interface</servlet-name>
        <servlet-class>apps.Product_Reviews_Interface</servlet-class>
    </servlet>
    <servlet>
        <servlet-name>Product_Details_Interface</servlet-name>
        <servlet-class>apps.Product_Details_Interface</servlet-class>
    </servlet>
    <servlet>
        <servlet-name>Create_Review</servlet-name>
        <servlet-class>apps.Create_Review</servlet-class>
    </servlet>
    <servlet>
        <servlet-name>Change_Review</servlet-name>
        <servlet-class>apps.Change_Review</servlet-class>
    </servlet>
    <servlet>
        <servlet-name>Delete_Review</servlet-name>
        <servlet-class>apps.Delete_Review</servlet-class>
    </servlet>
    <servlet>
        <servlet-name>Make_Review_Public</servlet-name>
        <servlet-class>apps.Make_Review_Public</servlet-class>
    </servlet>
    <servlet>
        <servlet-name>Send_Review_Change_Email_Request</servlet-name>
        <servlet-class>apps.Send_Review_Change_Email_Request</servlet-class>
    </servlet>
    <servlet>
        <servlet-name>Send_Review_Deletion_Email_Request</servlet-name>
        <servlet-class>apps.Send_Review_Deletion_Email_Request</servlet-class>
    </servlet>
    <servlet>
        <servlet-name>Enable_Review_Editing</servlet-name>
        <servlet-class>apps.Enable_Review_Editing</servlet-class>
    </servlet>
    <servlet>
        <servlet-name>Enable_Review_Deletion</servlet-name>
        <servlet-class>apps.Enable_Review_Deletion</servlet-class>
    </servlet>
    <servlet>
        <servlet-name>Search_Shopping_Cart</servlet-name>
        <servlet-class>apps.Search_Shopping_Cart</servlet-class>
    </servlet>
    <servlet>
        <servlet-name>Add_To_Cart</servlet-name>
        <servlet-class>apps.Add_To_Cart</servlet-class>
    </servlet>
    <servlet>
        <servlet-name>Change_Cart</servlet-name>
        <servlet-class>apps.Change_Cart</servlet-class>
    </servlet>
    <servlet>
        <servlet-name>Delete_From_Cart</servlet-name>
        <servlet-class>apps.Delete_From_Cart</servlet-class>
    </servlet>
    <servlet>
        <servlet-name>Create_Receipt</servlet-name>
        <servlet-class>apps.Create_Receipt</servlet-class>
    </servlet>
    <servlet>
        <servlet-name>Clear_All_Carts</servlet-name>
        <servlet-class>apps.Clear_All_Carts</servlet-class>
    </servlet>
    <servlet>
        <servlet-name>Admin_Change_For_Sale_Item_Categories</servlet-name>
        <servlet-class>apps.Admin_Change_For_Sale_Item_Categories</servlet-class>
    </servlet>
    <servlet>
        <servlet-name>Admin_Add_Item_For_Sale</servlet-name>
        <servlet-class>apps.Admin_Add_Item_For_Sale</servlet-class>
    </servlet>
    <servlet>
        <servlet-name>Admin_Change_Item_For_Sale</servlet-name>
        <servlet-class>apps.Admin_Change_Item_For_Sale</servlet-class>
    </servlet>
    <servlet>
        <servlet-name>Admin_Delete_Item_For_Sale</servlet-name>
        <servlet-class>apps.Admin_Delete_Item_For_Sale</servlet-class>
    </servlet>
    <servlet>
        <servlet-name>Admin_Add_Sale_Item_Pictures</servlet-name>
        <servlet-class>apps.Admin_Add_Sale_Item_Pictures</servlet-class>
    </servlet>
    <servlet>
        <servlet-name>Admin_Delete_Sale_Item_Pictures</servlet-name>
        <servlet-class>apps.Admin_Delete_Sale_Item_Pictures</servlet-class>
    </servlet>
    <servlet>
        <servlet-name>Admin_Extract_Receipts</servlet-name>
        <servlet-class>apps.Admin_Extract_Receipts</servlet-class>
    </servlet>
    <servlet>
        <servlet-name>Admin_Delete_Receipts</servlet-name>
        <servlet-class>apps.Admin_Delete_Receipts</servlet-class>
	</servlet>-->
  <servlet>
      	<servlet-name>boxOffice</servlet-name>
      	<servlet-class>org.springframework.framework.web.workflow.CommandServlet</servlet-class>
  </servlet> 
 
 
 
 
  <servlet-mapping>
        	<servlet-name>boxOffice</servlet-name>
        	<url-pattern>/*.html</url-pattern>
  </servlet-mapping>
 
  <servlet-mapping>
          	<servlet-name>config</servlet-name>
          	<url-pattern>/context/context.html</url-pattern>
  </servlet-mapping>
    <servlet-mapping>
        <servlet-name>For_Sale_Items_Interface</servlet-name>
        <url-pattern>/for-sale-items-interface</url-pattern>
    </servlet-mapping>
    <!--<servlet-mapping>
        <servlet-name>Admin_For_Sale_Items_Interface</servlet-name>
        <url-pattern>/admin-for-sale-items-interface</url-pattern>
    </servlet-mapping>
    <servlet-mapping>
        <servlet-name>Admin_Product_Details_Interface</servlet-name>
        <url-pattern>/admin-product-details-interface</url-pattern>
    </servlet-mapping>
    <servlet-mapping>
        <servlet-name>Product_Reviews_Interface</servlet-name>
        <url-pattern>/product-reviews-interface</url-pattern>
    </servlet-mapping>
    <servlet-mapping>
        <servlet-name>Product_Details_Interface</servlet-name>
        <url-pattern>/product-details-interface</url-pattern>
    </servlet-mapping>
    <servlet-mapping>
        <servlet-name>Create_Review</servlet-name>
        <url-pattern>/create-review</url-pattern>
    </servlet-mapping>
    <servlet-mapping>
        <servlet-name>Change_Review</servlet-name>
        <url-pattern>/change-review</url-pattern>
    </servlet-mapping>
    <servlet-mapping>
        <servlet-name>Delete_Review</servlet-name>
        <url-pattern>/delete-review</url-pattern>
    </servlet-mapping>
    <servlet-mapping>
        <servlet-name>Make_Review_Public</servlet-name>
        <url-pattern>/make-review-public</url-pattern>
    </servlet-mapping>
    <servlet-mapping>
        <servlet-name>Send_Review_Change_Email_Request</servlet-name>
        <url-pattern>/send-review-change-email-request</url-pattern>
    </servlet-mapping>
    <servlet-mapping>
        <servlet-name>Send_Review_Deletion_Email_Request</servlet-name>
        <url-pattern>/send-review-deletion-email-request</url-pattern>
    </servlet-mapping>
    <servlet-mapping>
        <servlet-name>Enable_Review_Editing</servlet-name>
        <url-pattern>/enable-review-editing</url-pattern>
    </servlet-mapping>
    <servlet-mapping>
        <servlet-name>Enable_Review_Deletion</servlet-name>
        <url-pattern>/enable-review-deletion</url-pattern>
    </servlet-mapping>
    <servlet-mapping>
        <servlet-name>Search_Shopping_Cart</servlet-name>
        <url-pattern>/search-shopping-cart</url-pattern>
    </servlet-mapping>
    <servlet-mapping>
        <servlet-name>Add_To_Cart</servlet-name>
        <url-pattern>/add-to-cart</url-pattern>
    </servlet-mapping>
    <servlet-mapping>
        <servlet-name>Change_Cart</servlet-name>
        <url-pattern>/change-cart</url-pattern>
    </servlet-mapping>
    <servlet-mapping>
        <servlet-name>Delete_From_Cart</servlet-name>
        <url-pattern>/delete-from-cart</url-pattern>
    </servlet-mapping>
    <servlet-mapping>
        <servlet-name>Create_Receipt</servlet-name>
        <url-pattern>/create-receipt</url-pattern>
    </servlet-mapping>
    <servlet-mapping>
        <servlet-name>Clear_All_Carts</servlet-name>
        <url-pattern>/clear-all-carts</url-pattern>
    </servlet-mapping>
    <servlet-mapping>
        <servlet-name>Admin_Change_For_Sale_Item_Categories</servlet-name>
        <url-pattern>/admin-change-for-sale-item-categories</url-pattern>
    </servlet-mapping>
    <servlet-mapping>
        <servlet-name>Admin_Add_Item_For_Sale</servlet-name>
        <url-pattern>/admin-add-item-for-sale</url-pattern>
    </servlet-mapping>
    <servlet-mapping>
        <servlet-name>Admin_Change_Item_For_Sale</servlet-name>
        <url-pattern>/admin-change-item-for-sale</url-pattern>
    </servlet-mapping>
    <servlet-mapping>
        <servlet-name>Admin_Delete_Item_For_Sale</servlet-name>
        <url-pattern>/admin-delete-item-for-sale</url-pattern>
    </servlet-mapping>
    <servlet-mapping>
        <servlet-name>Admin_Add_Sale_Item_Pictures</servlet-name>
        <url-pattern>/admin-add-sale-item-pictures</url-pattern>
    </servlet-mapping>
    <servlet-mapping>
        <servlet-name>Admin_Delete_Sale_Item_Pictures</servlet-name>
        <url-pattern>/admin-delete-sale-item-pictures</url-pattern>
    </servlet-mapping>
    <servlet-mapping>
        <servlet-name>Admin_Extract_Receipts</servlet-name>
        <url-pattern>/admin-extract-receipts</url-pattern>
    </servlet-mapping>
    <servlet-mapping>
        <servlet-name>Admin_Delete_Receipts</servlet-name>
        <url-pattern>/admin-delete-receipts</url-pattern>
    </servlet-mapping>-->

<session-config>
<session-timeout>60</session-timeout>
</session-config>

<welcome-file-list>
	<!-- Simply doesn't work to a servlet -->
	<welcome-file>/welcome.jsp</welcome-file>
</welcome-file-list>

<error-page>
     <error-code>403</error-code>
     <location>/jsp/layout/twocolumn/403-Forbidden.jsp</location>
  </error-page>
 
    <error-page>
       <error-code>404</error-code>
       <location>/jsp/layout/twocolumn/404-NotFound.jsp</location>
  </error-page>
 
  <error-page>
         <exception-type>java.lang.Throwable</exception-type>
         <location>/jsp/layout/twocolumn/uncaughtException.jsp</location>
  </error-page>
 
 <taglib>
 	      	<taglib-uri>/bind</taglib-uri>
 	      	<taglib-location>/WEB-INF/tlds/b11.tld</taglib-location>
   </taglib>
  
   <taglib>
   	      	<taglib-uri>/events</taglib-uri>
   	      	<taglib-location>/WEB-INF/tlds/event11.tld</taglib-location>
  </taglib>
 
  <security-constraint>
  	<web-resource-collection>
  	<web-resource-name>SalesInfo
  	</web-resource-name>
  	<url-pattern>purchase.html</url-pattern>
  	<http-method>GET</http-method>
  	<http-method>POST</http-method>
  	</web-resource-collection>
  	<auth-constraint>
  	<role-name>registeredUsers</role-name>
  	</auth-constraint>
  	<user-data-constraint>  	
  	<transport-guarantee>NONE</transport-guarantee>
  	</user-data-constraint>
</security-constraint>


 	<login-config>
 		<auth-method>FORM</auth-method>
 	
 		<!-- Used only for BASIC authentication: only included because ServletUnit needs it -->
 		<realm-name>ticket</realm-name>
 	
 		<form-login-config>
 			<form-login-page>login.jsp</form-login-page>
 			<form-error-page>loginError.jsp</form-error-page>
 		</form-login-config>
 	</login-config>
 
 
 	<security-role>
		<role-name>registeredUsers</role-name>
	</security-role>




<ejb-ref>
	<ejb-ref-name>ejb/FixtureManager</ejb-ref-name>
	<ejb-ref-type>Session</ejb-ref-type>
	<home>com.wrox.j2eedd.ticket.ejb.fixturemanager.FixtureManagerRemoteHome</home>
	<remote>com.wrox.j2eedd.ticket.ejb.fixturemanager.FixtureManagerRemote</remote>
	<ejb-link>FixtureManager</ejb-link>
</ejb-ref>


<ejb-ref>
	<ejb-ref-name>ejb/BoxOffice</ejb-ref-name>
	<ejb-ref-type>Session</ejb-ref-type>
	<home>com.wrox.j2eedd.ticket.ejb.booking.BoxOfficeRemoteHome</home>
	<remote>com.wrox.j2eedd.ticket.ejb.booking.BoxOfficeRemote</remote>
	<ejb-link>BookingManager</ejb-link>
</ejb-ref>

<ejb-ref>
	<ejb-ref-name>ejb/CustomerManager</ejb-ref-name>
	<ejb-ref-type>Session</ejb-ref-type>
	<home>com.wrox.j2eedd.ticket.ejb.customer.CustomerManagerRemoteHoms</home>
	<remote>com.wrox.j2eedd.ticket.ejb.customer.CustomerManagerRemote</remote>
	<ejb-link>CustomerManager</ejb-link>
</ejb-ref>

</web-app>
